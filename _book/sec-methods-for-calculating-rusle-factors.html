<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Methods for Calculating RUSLE Factors | The Revised Universal Soil Loss Equation (RUSLE) for post-fire soil erosion modelling.</title>
  <meta name="description" content="Methods for Calculating RUSLE Factors | The Revised Universal Soil Loss Equation (RUSLE) for post-fire soil erosion modelling." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Methods for Calculating RUSLE Factors | The Revised Universal Soil Loss Equation (RUSLE) for post-fire soil erosion modelling." />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Methods for Calculating RUSLE Factors | The Revised Universal Soil Loss Equation (RUSLE) for post-fire soil erosion modelling." />
  
  
  



<meta name="date" content="2023-02-27" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sec-Data-Requirements.html"/>
<link rel="next" href="sec-applying-the-rusle-equation.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html"><i class="fa fa-check"></i>Project Overview</a>
<ul>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#motivation"><i class="fa fa-check"></i>Motivation</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#objective"><i class="fa fa-check"></i>Objective</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="overview.html"><a href="overview.html#limitations"><i class="fa fa-check"></i>Limitations</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html"><i class="fa fa-check"></i>RUSLE Factors</a>
<ul>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-1"><i class="fa fa-check"></i>Factor 1 - Rainfall Erosivity (R)</a></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-2"><i class="fa fa-check"></i>Factor 2 - Slope Length (LS)</a></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#factor3"><i class="fa fa-check"></i>Factor 3 - Soil Erodibility (K)</a></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-4"><i class="fa fa-check"></i>Factor 4 - Crop/Vegetation and Management Factor (C)</a></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-5"><i class="fa fa-check"></i>Factor 5 - The Support Practice Factor (P)</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sec-Data-Requirements.html"><a href="sec-Data-Requirements.html"><i class="fa fa-check"></i>Data Requirements</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html"><i class="fa fa-check"></i>Methods for Calculating RUSLE Factors</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-required-r-packages"><i class="fa fa-check"></i>RStudio Preparation:</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#packages"><i class="fa fa-check"></i>Required R Packages:</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-rstudio-preparation"><i class="fa fa-check"></i>Setting the Coordinate Reference System:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-factor-1-method"><i class="fa fa-check"></i>Factor 1 - Rainfall Erosivity (R)</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-R-input-data"><i class="fa fa-check"></i>Input Data:</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-r-factor"><i class="fa fa-check"></i>Calculating the R Factor:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-2"><i class="fa fa-check"></i>Factor 2 - Slope Length (LS)</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-ls-input-data"><i class="fa fa-check"></i>Input Data:</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-ls-factor"><i class="fa fa-check"></i>Calculating the LS Factor:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-factor-3"><i class="fa fa-check"></i>Factor 3 - Soil Erodibility (K)</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-input-data-ls"><i class="fa fa-check"></i>Input Data:</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-k-factor"><i class="fa fa-check"></i>Calculating the K Factor:</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="factors.html"><a href="factors.html#sec-factor-4"><i class="fa fa-check"></i>Factor 4 - Crop/Vegetation and Management Factor</a>
<ul>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-input-data-c"><i class="fa fa-check"></i>Input Data:</a></li>
<li class="chapter" data-level="" data-path="sec-methods-for-calculating-rusle-factors.html"><a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-c-factor"><i class="fa fa-check"></i>Calculating the C Factor:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html"><i class="fa fa-check"></i>Applying the RUSLE Equation:</a>
<ul>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-application-1-rusle-post-burn"><i class="fa fa-check"></i>Application 1: RUSLE Post Burn</a>
<ul>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-1-load-rusle-factors"><i class="fa fa-check"></i>Step 1: Load RUSLE Factors</a></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-3-re-sample-rusle-factors"><i class="fa fa-check"></i>Step 2: Re-sample RUSLE Factors</a></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-4-combine-factors-using-the-rusle"><i class="fa fa-check"></i>Step 3: Combine Factors using the RUSLE</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-application-2-rusle-post-burn"><i class="fa fa-check"></i>Application 2: RUSLE Post Burn</a>
<ul>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-1-load-rusle-factors_post"><i class="fa fa-check"></i>Step 1: Load RUSLE Factors</a></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-3-resample-rusle-factors"><i class="fa fa-check"></i>Step 2: Re-sample RUSLE Factors</a></li>
<li class="chapter" data-level="" data-path="sec-applying-the-rusle-equation.html"><a href="sec-applying-the-rusle-equation.html#sec-step-4-combine-factors-using-the-rusle-post"><i class="fa fa-check"></i>Step 3: Combine Factors using the RUSLE</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">The Revised Universal Soil Loss Equation (RUSLE) for post-fire soil erosion modelling.</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="sec-methods-for-calculating-rusle-factors" class="section level1 unnumbered hasAnchor">
<h1>Methods for Calculating RUSLE Factors<a href="sec-methods-for-calculating-rusle-factors.html#sec-methods-for-calculating-rusle-factors" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Here, we explain how to calculate the factors required as inputs to the RUSLE for soil erosion modelling in a topographically complex area.</p>
<p>For each RUSLE factor (R, LS, K, C), we outline the input data required to calculate the factor and how it is calculated. <em>Note: The P factor is not included in this analysis</em>.</p>
<p>This application of the RUSLE uses data for the Trozzo and Winlaw Creek watersheds which are located in the West Kootenay region of southeastern British Columbia (<strong>Figure 1</strong>).</p>
<center>
<img src="img/studyarea.png" style="width:100.0%" />
</center>
<p><strong>Figure 1</strong> The Study area in the West Kootenay region of southeastern British Columbia, showing the two watersheds in the study area: Winlaw watershed (~41km^2), and the Trozzo Creek Watershed (~28km^2). Streams in the study area are shown in blue and the inset map situates the study area in the province of British Columbia.</p>
<div id="sec-required-r-packages" class="section level2 unnumbered hasAnchor">
<h2>RStudio Preparation:<a href="sec-methods-for-calculating-rusle-factors.html#sec-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="packages" class="section level3 unnumbered hasAnchor">
<h3>Required R Packages:<a href="sec-methods-for-calculating-rusle-factors.html#packages" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The method for applying the RUSLE is entirely open source and is integrated within the geospatial R ecosystem (i.e. <code>raster/terra/stars and sp/sf)</code>. This guide has been written to help both the RUSLE novice, as well as the seasoned geospatial analyst. Key packages used in this demonstration are:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra) </span>
<span id="cb1-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rgeos)</span>
<span id="cb1-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(raster)</span>
<span id="cb1-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sf)</span>
<span id="cb1-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(whitebox)</span>
<span id="cb1-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(sp)</span>
<span id="cb1-8"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(leaflet)</span>
<span id="cb1-9"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(magrittr)</span>
<span id="cb1-10"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-11"><a href="sec-methods-for-calculating-rusle-factors.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code></pre></div>
</div>
<div id="sec-rstudio-preparation" class="section level3 unnumbered hasAnchor">
<h3>Setting the Coordinate Reference System:<a href="sec-methods-for-calculating-rusle-factors.html#sec-rstudio-preparation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>All input raster and vector surfaces must have the same Coordinate Reference System (CRS):</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb2-1" aria-hidden="true" tabindex="-1"></a>projection <span class="ot">&lt;-</span> <span class="fu">crs</span>(<span class="st">&quot;+proj=utm +zone=11 +ellps=GRS80 +units=m +no_defs&quot;</span>)</span></code></pre></div>
</div>
</div>
<div id="sec-factor-1-method" class="section level2 unnumbered hasAnchor">
<h2>Factor 1 - Rainfall Erosivity (R)<a href="sec-methods-for-calculating-rusle-factors.html#sec-factor-1-method" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sec-R-input-data" class="section level3 unnumbered hasAnchor">
<h3>Input Data:<a href="sec-methods-for-calculating-rusle-factors.html#sec-R-input-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Data for the R factor is sourced from the <a href="https://esdac.jrc.ec.europa.eu/content/global-rainfall-erosivity#tabs-0-description=1">Rainfall erosivity dataset (2017)</a>. The provided R-factor map at resolutions of 30 arc-sec (~1 km at the Equator). This data offers complete global rainfall erosivity data based on 3625 precipitation stations and around 60,000 years of rainfall records at high temporal resolution (1 to 60 minutes). Rainfall erosivity values (MJ mm ha-1 h-1 yr-1) for the study area range between 483.7963 and 622.4443 MJ mm ha-1 h-1 yr-1. These values are consistent with those reported for British Columbia. For example, according to a report by <a href="https://sis.agr.gc.ca/cansis/publications/manuals/2002-92/rusle-can.pdf">Agriculture and Agri-Food Canada</a>, R values in Vancouver, B.C. are approximately 378 MJ mm ha-1 h-1. Marginally lower R values in the study area are explained by the geographic location of the study area, being inland from the west coast temperate zone.</p>
</div>
<div id="sec-calculating-the-r-factor" class="section level3 unnumbered hasAnchor">
<h3>Calculating the R Factor:<a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-r-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>For application with the RUSLE, the <a href="https://esdac.jrc.ec.europa.eu/content/global-rainfall-erosivity#tabs-0-description=1">Rainfall erosivity dataset (2017)</a> is clipped to the study area and saved to file (<strong>Figure 2</strong>):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb3-1" aria-hidden="true" tabindex="-1"></a>R_factor <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;data/4/R/R_factor.tif&quot;</span>,  <span class="at">res =</span> <span class="dv">1</span>)</span>
<span id="cb3-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb3-2" aria-hidden="true" tabindex="-1"></a>R_factor <span class="ot">&lt;-</span> <span class="fu">crop</span>(R_factor, crop_extent)</span></code></pre></div>
<center>
<img src="img/r_factor.png" style="width:100.0%" />
</center>
<p><strong>Figure 2</strong>: Rainfall factor (R) values, measured in MJ mm ha-1 h-1 yr-1, for the Winlaw and Trozzo Creek watersheds. The highest R values (max = 622) in the study area are located in the southwest, and the lowest values (min = 484) are located in the northeast. Data sourced from the <a href="https://esdac.jrc.ec.europa.eu/content/global-rainfall-erosivity#tabs-0-description=1">Rainfall erosivity dataset (2017)</a>.</p>
</div>
</div>
<div id="sec-factor-2" class="section level2 unnumbered hasAnchor">
<h2>Factor 2 - Slope Length (LS)<a href="factors.html#sec-factor-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this study, the LS factor is calculated based <a href="https://www.researchgate.net/publication/233425999_A_GIS_procedure_for_automatically_calculating_the_USLE_LS_factor_on_topographically_complex_landscape_units">Desmet and Gover., 1996</a>. Following <a href="https://www.researchgate.net/publication/233425999_A_GIS_procedure_for_automatically_calculating_the_USLE_LS_factor_on_topographically_complex_landscape_units">Desmet and Gover., 1996</a> several sub-factors are calculated and used to inform the production of a final LS raster surface.</p>
<div id="sec-ls-input-data" class="section level3 unnumbered hasAnchor">
<h3>Input Data:<a href="sec-methods-for-calculating-rusle-factors.html#sec-ls-input-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The only required input for calculating the LS factor is a Digital elevation model (DEM). Here, we test the method using a 1m resolution DEM derived from LiDAR data (<strong>Figure 3a</strong>) and a 25m resolution DEM (<strong>Figure 3b</strong>).</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb4-1" aria-hidden="true" tabindex="-1"></a>dem <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;DTM/dem.tif&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="img/dem_1m.png" alt="" />
<p class="caption"><strong>Figure 3a</strong>: Digital Elevation Model (DEM) in meters (m), for the Winlaw and Trozzo Creek watersheds. The maximum elevation in the study area is 1,816 m and the minimum is 678 m. The DEM resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/dem_25m.png" alt="" />
<p class="caption"><strong>Figure 3b</strong>: Digital Elevation Model (DEM) in meters (m), for the Winlaw and Trozzo Creek watersheds. The maximum elevation in the study area is 1,816 m and the minimum is 678 m. The DEM resolution is 25m.</p>
</div>
</div>
<div id="sec-calculating-the-ls-factor" class="section level3 unnumbered hasAnchor">
<h3>Calculating the LS Factor:<a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-ls-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Calculating the LS factor involves nine steps:</p>
<div id="sec-step-1-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 1: Slope Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-1-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The first step in calumniating the LS factor is the production of twp slope raster’s using the 1m DEM and 25m DEM (see <strong>Figure 4a and 4b</strong>)).</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Slope - Degrees</span></span>
<span id="cb5-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_slope</span>(</span>
<span id="cb5-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dem =</span> <span class="st">&quot;DTM/dem.tif&quot;</span>, </span>
<span id="cb5-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">&quot;SLOPE/slope_degrees.tif&quot;</span>,</span>
<span id="cb5-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">zfactor =</span> <span class="cn">NULL</span>, </span>
<span id="cb5-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;degrees&quot;</span>)</span>
<span id="cb5-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb5-7" aria-hidden="true" tabindex="-1"></a>slope_degrees <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;SLOPE/slope_degrees.tif&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="img/slope_degrees_1m.png" alt="" />
<p class="caption"><strong>Figure 4a</strong>: Slope raster in degrees, for the Winlaw and Trozzo Creek watersheds. The maximum slope in the study area is 90 degrees and the minimum is 0 degrees. The DEM resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/slope_degrees_25m.png" alt="" />
<p class="caption"><strong>Figure 4b</strong>: Slope raster in degrees, for the Winlaw and Trozzo Creek watersheds. The maximum slope in the study area is 90 degrees and the minimum is 0 degrees. The DEM resolution is 25m.</p>
</div>
<p>The slope is also produced in percent using the following code:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Slope - Percent</span></span>
<span id="cb6-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_slope</span>(</span>
<span id="cb6-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">dem =</span> <span class="st">&quot;DTM/dem.tif&quot;</span>, </span>
<span id="cb6-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">output =</span> <span class="st">&quot;SLOPE/slope_percent.tif&quot;</span>,</span>
<span id="cb6-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">zfactor =</span> <span class="cn">NULL</span>, </span>
<span id="cb6-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">units =</span> <span class="st">&quot;percent&quot;</span>)</span>
<span id="cb6-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb6-7" aria-hidden="true" tabindex="-1"></a>slope_percent <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="st">&quot;SLOPE/slope_percent.tif&quot;</span>)</span></code></pre></div>
</div>
<div id="sec-step-2-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 2: Beta<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-2-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, Beta is calculated using the 1m and 25m resolution <code>slope_degrees</code> rasters generated in Step 1 and the formula proposed by <a href="https://www.researchgate.net/publication/233425999_A_GIS_procedure_for_automatically_calculating_the_USLE_LS_factor_on_topographically_complex_landscape_units">Desmet and Gover., 1996</a> (<strong>Figure 5a and 5b</strong>).</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb7-1" aria-hidden="true" tabindex="-1"></a>θ <span class="ot">&lt;-</span> slope_degrees<span class="sc">*</span>pi<span class="sc">/</span><span class="dv">180</span> <span class="co"># convert degrees to radians</span></span>
<span id="cb7-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb7-2" aria-hidden="true" tabindex="-1"></a>beta <span class="ot">=</span> ((<span class="fu">sin</span>(θ))<span class="sc">/</span>(<span class="fl">0.0896</span>))<span class="sc">/</span>((<span class="fl">0.56</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> (<span class="fu">sin</span>(θ))<span class="sc">**</span><span class="fl">0.8</span>))</span></code></pre></div>
<div class="figure">
<img src="img/beta_1m.png" alt="" />
<p class="caption"><strong>Figure 5a</strong>: Beta for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 3.14m and the minimum value is 0.02. The beta resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/beta_25m.png" alt="" />
<p class="caption"><strong>Figure 5b</strong>: Beta for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 2.98m and the minimum value is 0. The beta resolution is 25m.</p>
</div>
</div>
<div id="sec-step-3-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 3: Ratio of Rill to Interrill Erosivity (m)<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-3-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The output of Step 2, <code>beta</code>, is used to calculate the ration of rill to interrill erosion, called <code>m</code>, for each grid cell (<strong>Figure 6a and 6b</strong>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb8-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">=</span> (beta)<span class="sc">/</span>(beta <span class="sc">+</span> <span class="dv">1</span>) <span class="fu">plot</span>(m)</span></code></pre></div>
<div class="figure">
<img src="img/m_1m.png" alt="" />
<p class="caption"><strong>Figure 6a</strong>: Ratio of Rill to Interrill Erosivity (m) for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 0.76m and the minimum value is 0.02. The resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/m_25m.png" alt="" />
<p class="caption"><strong>Figure 6b</strong>: Ratio of Rill to Interrill Erosivity (m) for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 0.76m and the minimum value is 0.02. The resolution is 25m.</p>
</div>
</div>
<div id="sec-step-4-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 4: Aspect Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-4-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, the <code>terrain</code> function from the <code>raster</code> package and the <code>dem</code> (1m and 25m) are used to produce an aspect, in radians, of the study area (<strong>Figure 7a and 7b</strong>).</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb9-1" aria-hidden="true" tabindex="-1"></a>aspect_radians <span class="ot">&lt;-</span>  <span class="fu">terrain</span>(dem, <span class="at">opt=</span><span class="st">&#39;aspect&#39;</span>, <span class="at">unit=</span><span class="st">&#39;radians&#39;</span>, <span class="at">neighbors=</span><span class="dv">8</span>, </span>
<span id="cb9-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb9-2" aria-hidden="true" tabindex="-1"></a>                           <span class="at">filename=</span> <span class="st">&quot;ASPECT/aspect_radians.tif&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="img/aspect_1m.png" alt="" />
<p class="caption"><strong>Figure 7a</strong>: Aspect, in radians, for the Winlaw and Trozzo Creek watersheds. The maximum aspect value in the study area is 6.28 and the minimum value is 0 . The resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/aspect_25m.png" alt="" />
<p class="caption"><strong>Figure 7b</strong>: Aspect, in radians, for the Winlaw and Trozzo Creek watersheds. The maximum aspect value in the study area is 6.28 and the minimum value is 0. The resolution is 25m.</p>
</div>
</div>
<div id="sec-step-5-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 5: Contour Width Factor (X)<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-5-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Using the <code>aspect_radians</code> raster produced in Step 4 a contour width factor, named <code>X</code> , is calculated based on the method proposed by <a href="https://www.researchgate.net/publication/233425999_A_GIS_procedure_for_automatically_calculating_the_USLE_LS_factor_on_topographically_complex_landscape_units">Desmet and Gover., 1996</a> (<strong>Figure 8a and 8b</strong>).</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb10-1" aria-hidden="true" tabindex="-1"></a>sin <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">sin</span>(aspect_radians))</span>
<span id="cb10-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb10-2" aria-hidden="true" tabindex="-1"></a>cos <span class="ot">&lt;-</span> <span class="fu">abs</span>(<span class="fu">cos</span>(aspect_radians))</span>
<span id="cb10-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb10-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">=</span> <span class="fu">abs</span>(<span class="fu">sin</span>(aspect_radians)) <span class="sc">+</span> <span class="fu">abs</span>(<span class="fu">cos</span>(aspect_radians))</span></code></pre></div>
<div class="figure">
<img src="img/x_1m.png" alt="" />
<p class="caption"><strong>Figure 8a</strong>: Contour width factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 1.41 and the minimum value is 1. The resolution is 1m.</p>
</div>
<div class="figure">
<img src="img/x_25m.png" alt="" />
<p class="caption"><strong>Figure 8b</strong>: Contour width factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 1.41 and the minimum value is 1. The resolution is 25m.</p>
</div>
</div>
<div id="sec-step-6-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 6: Specific Contributing Area<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-6-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Step 6 involves the production of a Specific Contributing Area raster using the <code>WhiteboxTools</code> function <code>wbt_fd8_flow_accumulation</code> (<strong>Figure 9a and 9b</strong>)).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wbt_fd8_flow_accumulation</span>(</span>
<span id="cb11-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-2" aria-hidden="true" tabindex="-1"></a>      <span class="at">dem =</span> <span class="st">&quot;DTM/dem.tif&quot;</span>, </span>
<span id="cb11-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-3" aria-hidden="true" tabindex="-1"></a>      <span class="at">output =</span> <span class="st">&quot;FD8_FLOW_ACCUMUMULATION/fd8_flow_accumulation.tif&quot;</span>,</span>
<span id="cb11-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">out_type =</span> <span class="st">&quot;specific contributing area&quot;</span>,</span>
<span id="cb11-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">exponent =</span> <span class="fl">1.1</span>,</span>
<span id="cb11-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">log =</span> <span class="cn">FALSE</span></span>
<span id="cb11-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    )</span></code></pre></div>
<div class="figure">
<img src="img/a_1m_MAX.png" alt="" />
<p class="caption"><strong>Figure 9a</strong>: Specific contributing area (A), in pixels, for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 358,753 pixels and the minimum value is 1 pixel. The resolution is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/fd8_1m_hist.png" alt="" />
<p class="caption"><strong>Figure 9a (accompanying histogram):</strong> Specific contributing area (A) for the Winlaw and Trozzo Creek watersheds. Plot showing limits set to 0 - 5000 pixels. Pixel value is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/a_25m.png" alt="" />
<p class="caption"><strong>Figure 9b</strong>: Specific contributing area (A) for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 118,414 and the minimum value is 25. The resolution is 25m.</p>
</div>
<center>
<div class="figure">
<img src="img/fd8_25m_hist.png" alt="" />
<p class="caption"><strong>Figure 9b (accompanying histogram):</strong> Specific contributing area (A) for the Winlaw and Trozzo Creek watersheds. Plot showing limits set to 0 - 5000 pixels. Pixel value is 25m.</p>
</div>
<center>
<p>The Specific Contributing Area raster is edited so that all cells with a value &gt; 100 are replaced with 100, our flow distance threshold. The resulting raster is named A (**Figure 10a and 10b).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb12-1" aria-hidden="true" tabindex="-1"></a>fd8_flow_accumulation_duplicate[fd8_flow_accumulation_duplicate <span class="sc">&gt;</span> <span class="dv">100</span>] <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb12-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb12-3" aria-hidden="true" tabindex="-1"></a>A <span class="ot">&lt;-</span> fd8_flow_accumulation_duplicate</span></code></pre></div>
<div class="figure">
<img src="img/a_1m_100m_cap.png" alt="" />
<p class="caption"><strong>Figure 10a</strong>: Specific contributing area (A) with a 100m threshold for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 100 and the minimum value is 1. The resolution is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/A_1m_hist.png" alt="" />
<p class="caption"><strong>Figure 10a (accompanying histogram)</strong>: Specific contributing area (A) for the Winlaw and Trozzo Creek watersheds with a 100m threshold. Plot showing limits set to 0 - 100 pixels. Pixel value is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/a_25m_100m_cap.png" alt="" />
<p class="caption"><strong>Figure 10b</strong>: Specific contributing area (A) with a 100m threshold for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 100 and the minimum value is 25. The resolution is 25m.</p>
</div>
<center>
<div class="figure">
<img src="img/A_25m_hist_N.png" alt="" />
<p class="caption"><strong>Figure 10b (accompanying histogram):</strong> Specific contributing area (A) for the Winlaw and Trozzo Creek watersheds with a 100m threshold. Plot showing limits set to 0 - 100. Pixel value is 25m.</p>
</div>
<center>
</div>
<div id="sec-step-7-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 7: Length (L) Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-7-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The length (L) component of the LS factor is calculated based on the equation proposed by <a href="https://www.researchgate.net/publication/233425999_A_GIS_procedure_for_automatically_calculating_the_USLE_LS_factor_on_topographically_complex_landscape_units">Desmet and Gover., 1996</a> and uses the <code>m,</code> <code>X</code>, and <code>A</code> sub-factors (<strong>Figure 11a and 11b</strong>)).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb13-1" aria-hidden="true" tabindex="-1"></a>L <span class="ot">=</span> (((A <span class="sc">+</span>(D<span class="sc">**</span><span class="dv">2</span>))<span class="sc">**</span>(m<span class="sc">+</span><span class="dv">1</span>))<span class="sc">-</span>(A<span class="sc">**</span>(m<span class="sc">+</span><span class="dv">1</span>)))<span class="sc">/</span>((D<span class="sc">**</span>(m<span class="sc">+</span><span class="dv">2</span>))<span class="sc">*</span>(x<span class="sc">**</span>m)<span class="sc">*</span>(<span class="fl">22.13</span><span class="sc">**</span>m))</span></code></pre></div>
<div class="figure">
<img src="img/l_1m.png" alt="" />
<p class="caption"><strong>Figure 11a</strong>: Length (L) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 4.82 and the minimum value is 0.45. The resolution is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/L_1m_hist.png" alt="" />
<p class="caption"><strong>Figure 11a (accompanying histogram):</strong> Length factor (L) for the Winlaw and Trozzo Creek watersheds. Pixel value is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/l_25m.png" alt="" />
<p class="caption"><strong>Figure 11b</strong>: Length (L) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 1.1 and the minimum value is 0.85. The resolution is 25m.</p>
</div>
<center>
<div class="figure">
<img src="img/L_25m_hist.png" alt="" />
<p class="caption"><strong>Figure 11a (accompanying histogram):</strong> Length factor (L) for the Winlaw and Trozzo Creek watersheds. Pixel value is 25m.</p>
</div>
<center>
</div>
<div id="sec-step-8-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 8: Slope (S) Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-8-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The slope (S) component of the LS factor is calculated based on the equation proposed by <a href="https://www.tandfonline.com/doi/full/10.1080/17445647.2019.1585980">Schmidt et al. 2019</a> and uses the <code>slope_percent</code> raster produced in Step 1 (<strong>Figure 12a and 12b</strong>).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb14-1" aria-hidden="true" tabindex="-1"></a>S <span class="ot">=</span> (<span class="fl">0.0005</span><span class="sc">*</span>(slope_percent<span class="sc">**</span><span class="dv">2</span>)) <span class="sc">+</span> (<span class="fl">0.1795</span><span class="sc">*</span>slope_percent) <span class="sc">-</span> (<span class="fl">0.4418</span>)</span>
<span id="cb14-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb14-2" aria-hidden="true" tabindex="-1"></a>S[S <span class="sc">&lt;</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code></pre></div>
<div class="figure">
<img src="img/S_1m.png" alt="" />
<p class="caption"><strong>Figure 12a</strong>: Slope (S) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 36.2 and the minimum value is 0. The resolution is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/S_1m_hist.png" alt="" />
<p class="caption"><strong>Figure 12a (accompanying histogram)</strong>: Slope factor (S) for the Winlaw and Trozzo Creek watersheds. Pixel value is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/S_25m.png" alt="" />
<p class="caption"><strong>Figure 12b</strong>: Slope (S) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 44.26 and the minimum value is 0. The resolution is 25m.</p>
</div>
<center>
<div class="figure">
<img src="img/S_25m_hist.png" alt="" />
<p class="caption"><strong>Figure 13b (accompanying histogram):</strong> Slope factor (S) for the Winlaw and Trozzo Creek watersheds. Pixel value is 25m.</p>
</div>
<center>
</div>
<div id="sec-step-9-ls" class="section level4 unnumbered hasAnchor">
<h4>Step 9: LS Factor<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-9-ls" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final step for calculating the LS factor is the combination of the <code>L</code> and <code>S</code> raster’s produced in Steps 7 and 9 respectively (<strong>Figure 14a and 14b</strong>)).</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb15-1" aria-hidden="true" tabindex="-1"></a>LS <span class="ot">=</span> L<span class="sc">*</span>S</span></code></pre></div>
<div class="figure">
<img src="img/LS_1m.png" alt="" />
<p class="caption"><strong>Figure 14a</strong>: Slope Length (LS) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 85 and the minimum value is 0. The resolution is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/LS_1m_hist.png" alt="" />
<p class="caption"><strong>Figure 14a (accompanying histogram)</strong>: Slope Length factor (LS) for the Winlaw and Trozzo Creek watersheds. Pixel value is 1m.</p>
</div>
<center>
<div class="figure">
<img src="img/LS_25m.png" alt="" />
<p class="caption"><strong>Figure 14b</strong>: Slope Length (LS) factor for the Winlaw and Trozzo Creek watersheds. The maximum value in the study area is 43 and the minimum value is 0. The resolution is 25m.</p>
</div>
<center>
<div class="figure">
<img src="img/LS_25m_hist.png" alt="" />
<p class="caption"><strong>Figure 14b (accompanying histogram):</strong> Slope Length factor (LS) for the Winlaw and Trozzo Creek watersheds. Pixel value is 25m</p>
</div>
<center>
</div>
</div>
</div>
<div id="sec-factor-3" class="section level2 unnumbered hasAnchor">
<h2>Factor 3 - Soil Erodibility (K)<a href="sec-methods-for-calculating-rusle-factors.html#sec-factor-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sec-input-data-ls" class="section level3 unnumbered hasAnchor">
<h3>Input Data:<a href="sec-methods-for-calculating-rusle-factors.html#sec-input-data-ls" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>K factor (soil erodibility) values are based on values provided by the <a href="http://www.omafra.gov.on.ca/english/engineer/facts/12-051.htm">Ontario Ministry of Agriculture, Food and Rural Affairs</a> and soil data from the <a href="https://catalogue.data.gov.bc.ca/dataset/20150a67-5a2d-425f-8216-ff0f97f68df9">British Columbia Soil Survey</a>. These K estimations are based on the information obtained on approximately 1600 samples collected in Southern Ontario by Ontario Institute of Pedology surveyors. Values used here follow the recommendation by <a href="https://sis.agr.gc.ca/cansis/publications/manuals/2002-92/rusle-can.pdf">Wall et al., 2002</a> (<strong>Figure 15</strong>). They suggest that if the organic matter content of a soil is unknown and cannot be obtained through extensive soil testing fieldwork, ‘average K’ values should be used for RUSLE modelling.</p>
<p><img src="img/k_factor_input.png" /></p>
<p><strong>Figure 15</strong>: Soil Erodibility (K) input data for for the study area located in West Kootenay region of southeastern British Columbia. Data sourced from the Ontario Ministry of Agriculture, Food and Rural Affairs](<a href="http://www.omafra.gov.on.ca/english/engineer/facts/12-051.htm" class="uri">http://www.omafra.gov.on.ca/english/engineer/facts/12-051.htm</a>) and soil data from the <a href="https://catalogue.data.gov.bc.ca/dataset/20150a67-5a2d-425f-8216-ff0f97f68df9">British Columbia Soil Survey</a>.</p>
</div>
<div id="sec-calculating-the-k-factor" class="section level3 unnumbered hasAnchor">
<h3>Calculating the K Factor:<a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-k-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The first step for calculating K values is to tidy data and determine the average K value by soil texture. There are three soil textures in the study area (according to the <a href="https://catalogue.data.gov.bc.ca/dataset/20150a67-5a2d-425f-8216-ff0f97f68df9">British Columbia Soil Survey</a>) (<strong>Table 3</strong>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb16-1" aria-hidden="true" tabindex="-1"></a>trozzo_soils <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;data/4/K/trozzo_Soils.shp&quot;</span>) <span class="co">#BC soils data</span></span>
<span id="cb16-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb16-2" aria-hidden="true" tabindex="-1"></a>winlaw_soils <span class="ot">&lt;-</span> <span class="fu">read_sf</span>(<span class="st">&quot;data/4/K/winlaw_Soils.shp&quot;</span>) <span class="co">#BC soils data</span></span>
<span id="cb16-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb16-3" aria-hidden="true" tabindex="-1"></a>trozzo_winlaw_soils <span class="ot">&lt;-</span><span class="fu">rbind</span>(trozzo_soils, winlaw_soils) <span class="co">#Combine BC soils data</span></span>
<span id="cb16-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb16-4" aria-hidden="true" tabindex="-1"></a>K_values <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">&quot;data/4/K/K_values.xlsx&quot;</span>) <span class="co">#Pre-determined K values</span></span>
<span id="cb16-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb16-5" aria-hidden="true" tabindex="-1"></a>K_values <span class="ot">&lt;-</span> <span class="fu">subset</span>((<span class="fu">merge</span>(trozzo_winlaw_soils, K_values, <span class="at">by =</span> <span class="st">&quot;TEXTURE_1&quot;</span>, <span class="at">all.x =</span> <span class="cn">TRUE</span>)), <span class="at">select =</span> <span class="fu">c</span>(Average_K, TEXTURE_1, AREA_SQM))</span></code></pre></div>
<p><strong>Table 3.</strong> Soil erodibility values (K) for study area soil textures (Loamy Sand, Silty Loam, Sandy Loam), and the percentage area of soil class per watershed.</p>
<table class=" lightable-classic-2" style="font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
Watershed
</th>
<th style="text-align:left;">
Soil Texture
</th>
<th style="text-align:right;">
Average K Value
</th>
<th style="text-align:right;">
Percentage Area (%)
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Trozzo Creek
</td>
<td style="text-align:left;">
Loamy Sand
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
35.8
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Silty Loam
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
0.2
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sandy Loam
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
64.0
</td>
</tr>
<tr>
<td style="text-align:left;">
Winlaw Creek
</td>
<td style="text-align:left;">
Loamy Sand
</td>
<td style="text-align:right;">
0.005
</td>
<td style="text-align:right;">
46.0
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Silty Loam
</td>
<td style="text-align:right;">
0.017
</td>
<td style="text-align:right;">
0.0
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
Sandy Loam
</td>
<td style="text-align:right;">
0.050
</td>
<td style="text-align:right;">
54.0
</td>
</tr>
</tbody>
</table>
<p>To produce a K value raster (<strong>Figure 16</strong>), an empty raster must be built using the <code>raster</code> package, this raster will be populated with K values and have the same resolution and extent as the R factor raster:</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-1" aria-hidden="true" tabindex="-1"></a>empty_raster <span class="ot">&lt;-</span> <span class="fu">reclassify</span>(R_factor, <span class="fu">cbind</span>(<span class="dv">0</span>, <span class="dv">800</span>, <span class="dv">0</span>), <span class="at">right=</span><span class="cn">FALSE</span>)</span>
<span id="cb17-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-2" aria-hidden="true" tabindex="-1"></a>K_factor <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(K_values, y, <span class="at">field =</span> <span class="st">&quot;Average_K&quot;</span>, </span>
<span id="cb17-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fun =</span> <span class="st">&quot;max&quot;</span>, <span class="at">background =</span> <span class="fl">0.001</span>)</span>
<span id="cb17-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-4" aria-hidden="true" tabindex="-1"></a>empty_raster <span class="ot">&lt;-</span> <span class="fu">raster</span>(<span class="at">ncol =</span> <span class="dv">11689</span>, <span class="at">nrow =</span> <span class="dv">11737</span> , </span>
<span id="cb17-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">crs =</span> <span class="fu">crs</span>(R_factor), <span class="at">resolution =</span> <span class="fu">res</span>(R_factor))</span>
<span id="cb17-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">extent</span>(empty_raster) <span class="ot">&lt;-</span> <span class="fu">extent</span>(R_factor)</span>
<span id="cb17-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-7" aria-hidden="true" tabindex="-1"></a>K_factor <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(K_values, R_factor, <span class="at">field =</span> <span class="st">&quot;Average_K&quot;</span>,</span>
<span id="cb17-8"><a href="sec-methods-for-calculating-rusle-factors.html#cb17-8" aria-hidden="true" tabindex="-1"></a>                      <span class="at">fun =</span> <span class="st">&quot;max&quot;</span>, <span class="at">background =</span> <span class="fl">0.001</span>)</span></code></pre></div>
<center>
<div class="figure">
<img src="img/k_factor.png" alt="" />
<p class="caption"><strong>Figure 16</strong>: Soil erodibility factor (K) values measured the percentage erodiibilty of soil textures for the Winlaw and Trozzo Creek watershed study areas. The highest K values (max = 0.050) are associated with the Silty Loam soil texture, and the lowest K values (min = 0.005) are associated with the Loamy Sand texture. Data sourced from the British Columbia Soil Survey.</p>
</div>
</center>
<p><strong>Figure 16</strong>: Soil erodibility factor (K) values measured the percentage erodiibilty of soil textures for the Winlaw and Trozzo Creek watershed study areas. The highest K values (max = 0.050) are associated with the Silty Loam soil texture, and the lowest K values (min = 0.005) are associated with the Loamy Sand texture. Data sourced from the <a href="https://catalogue.data.gov.bc.ca/dataset/20150a67-5a2d-425f-8216-ff0f97f68df9">British Columbia Soil Survey</a>.</p>
</div>
</div>
<div id="sec-factor-4" class="section level2 unnumbered hasAnchor">
<h2>Factor 4 - Crop/Vegetation and Management Factor<a href="factors.html#sec-factor-4" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div id="sec-input-data-c" class="section level3 unnumbered hasAnchor">
<h3>Input Data:<a href="sec-methods-for-calculating-rusle-factors.html#sec-input-data-c" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>There are no current, or recorded soil erosion management practices being implemented in the study area. Therefore the C factor is is based on:</p>
<ol style="list-style-type: decimal">
<li>Vegetation cover, specified by the <a href="https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/forest-inventory">Vegetation Resource Inventory(VRI)</a> (<strong>Figure 17</strong>)) .</li>
</ol>
<center>
<img src="img/c_factor_input_vri.png" />
</center>
<p><strong>Figure 17</strong> Crop/Vegetation and Management Factor (C) Vegetation Resource Inventory (VRI) data for for the study area located in West Kootenay region of southeastern British Columbia. Data sourced from the <a href="https://www2.gov.bc.ca/gov/content/industry/forestry/managing-our-forest-resources/forest-inventory">Vegetation Resource Inventory (VRI)</a>.</p>
<ol start="2" style="list-style-type: decimal">
<li>Fire Burn Severity, specified by provincial <a href="https://catalogue.data.gov.bc.ca/dataset/fire-burn-severity-historical">Burn Severity Mapping</a> completed using Landsat or Satellite imagery (<strong>Figure 18</strong>).</li>
</ol>
<center>
<img src="img/c_factor_input_bs.png" />
</center>
<p><strong>Figure 18</strong>: Crop/Vegetation and Management Factor (C) Burn Severity Mapping data for for the study area located in West Kootenay region of southeastern British Columbia. Data sourced from BC <a href="https://catalogue.data.gov.bc.ca/dataset/fire-burn-severity-historical">Burn Severity Mapping</a> completed using Landsat or Satellite imagery.</p>
<ol start="3" style="list-style-type: decimal">
<li>Road network, sourced from the provincial <a href="https://www2.gov.bc.ca/gov/content/data/geographic-data-services/topographic-data/roads">Digital Road Atlas</a> (<strong>Figure 19</strong>)</li>
</ol>
<center>
<img src="img/c_factor_input_roads10m.png" />{
</center>
<p><strong>Figure 19</strong>: Crop/Vegetation and Management Factor (C) Road data for for the study area located in West Kootenay region of southeastern British Columbia. Data sourced from BC <a href="https://www2.gov.bc.ca/gov/content/data/geographic-data-services/topographic-data/roads">Digital Road Atlas</a> and bufferd to 10m.</p>
</div>
<div id="sec-calculating-the-c-factor" class="section level3 unnumbered hasAnchor">
<h3>Calculating the C Factor:<a href="sec-methods-for-calculating-rusle-factors.html#sec-calculating-the-c-factor" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>C Factor values are assigned to each Crop/Vegetation and Management input, and vary depending on the impact (Table <a href="#tab:4"><strong>??</strong></a>).</p>
<p><strong>Table 4</strong>: Crop/Vegetation and Management values (K) for the study area for Vegetation Resource Inventory (VRI) class, Burn Severity, and Road presence.</p>
<table class=" lightable-classic-2" style="font-family: Times New Roman; width: auto !important; margin-left: auto; margin-right: auto;">
<thead>
<tr>
<th style="text-align:left;">
C Factor Class
</th>
<th style="text-align:right;">
C Factor Value
</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left;">
Burn Severity - High
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
Burn Severity - Medium
</td>
<td style="text-align:right;">
0.05
</td>
</tr>
<tr>
<td style="text-align:left;">
Burn Severity - Low
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
VRI - Treed
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
VRI - Herb
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
VRI - Shrub
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
VRI - Rock
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
<tr>
<td style="text-align:left;">
VRI - Exposed Land
</td>
<td style="text-align:right;">
0.01
</td>
</tr>
<tr>
<td style="text-align:left;">
Roads
</td>
<td style="text-align:right;">
0.20
</td>
</tr>
</tbody>
</table>
<p>Calculating the C factor involves seven steps:</p>
<div id="sec-step-1-reclassifying-vri-data-c" class="section level4 unnumbered hasAnchor">
<h4>Step 1: Reclassifying VRI Data<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-1-reclassifying-vri-data-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-1" aria-hidden="true" tabindex="-1"></a>vri_data <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/VRI.shp&quot;</span>)</span>
<span id="cb18-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-2" aria-hidden="true" tabindex="-1"></a>vri_data[<span class="st">&#39;C_Factor&#39;</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>()</span>
<span id="cb18-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-4" aria-hidden="true" tabindex="-1"></a>vri_data <span class="sc">%&gt;%</span></span>
<span id="cb18-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C_Factor =</span> <span class="fu">case_when</span>(</span>
<span id="cb18-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;HE&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;TB&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-8"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;TM&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-9"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;SL&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-10"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;EL&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-11"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;TC&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-12"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;RO&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.2</span>),</span>
<span id="cb18-13"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_4, <span class="st">&quot;ST&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb18-14"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BCLCS_LV_3, <span class="st">&quot;W&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>)</span>
<span id="cb18-15"><a href="sec-methods-for-calculating-rusle-factors.html#cb18-15" aria-hidden="true" tabindex="-1"></a>    ))</span></code></pre></div>
</div>
<div id="sec-step-2-reclassifying-burn-severity-data-c" class="section level4 unnumbered hasAnchor">
<h4>Step 2: Reclassifying Burn Severity Data<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-2-reclassifying-burn-severity-data-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-1" aria-hidden="true" tabindex="-1"></a>BurnSeverity <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">&quot;data/BurnSeverity.shp&quot;</span>)</span>
<span id="cb19-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-2" aria-hidden="true" tabindex="-1"></a>BurnSeverity[<span class="st">&#39;C_Factor&#39;</span>] <span class="ot">=</span> <span class="fu">as.numeric</span>()</span>
<span id="cb19-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-4" aria-hidden="true" tabindex="-1"></a>BurnSeverity <span class="sc">%&gt;%</span></span>
<span id="cb19-5"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">C_Factor =</span> <span class="fu">case_when</span>(</span>
<span id="cb19-6"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BurnSev, <span class="st">&quot;High&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.2</span>), </span>
<span id="cb19-7"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BurnSev, <span class="st">&quot;Low&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.01</span>), </span>
<span id="cb19-8"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">endsWith</span>(BurnSev, <span class="st">&quot;Medium&quot;</span>) <span class="sc">~</span> <span class="fu">as.numeric</span>(<span class="fl">0.05</span>)</span>
<span id="cb19-9"><a href="sec-methods-for-calculating-rusle-factors.html#cb19-9" aria-hidden="true" tabindex="-1"></a>    ))</span></code></pre></div>
</div>
<div id="step-3-reclassifying-and-buffering-road-data" class="section level4 unnumbered hasAnchor">
<h4>Step 3: Reclassifying and Buffering Road Data<a href="sec-methods-for-calculating-rusle-factors.html#step-3-reclassifying-and-buffering-road-data" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb20-1" aria-hidden="true" tabindex="-1"></a>roads_buff_10 <span class="ot">&lt;-</span> <span class="fu">st_buffer</span>(roads, <span class="dv">10</span>)</span>
<span id="cb20-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb20-2" aria-hidden="true" tabindex="-1"></a>roads_buff_10<span class="sc">$</span>C_Factor <span class="ot">&lt;-</span> <span class="fl">0.2</span></span></code></pre></div>
</div>
<div id="sec-step-3-vri-polygon-to-raster-c" class="section level4 unnumbered hasAnchor">
<h4>Step 4: VRI Polygon to Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-3-vri-polygon-to-raster-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb21-1" aria-hidden="true" tabindex="-1"></a>vri_data_spdf <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(vri_data)</span>
<span id="cb21-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb21-2" aria-hidden="true" tabindex="-1"></a>empty_raster <span class="ot">&lt;-</span><span class="fu">raster</span>(<span class="at">res =</span> <span class="dv">1</span>, <span class="at">ext =</span> extent)</span>
<span id="cb21-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(empty_raster) <span class="ot">&lt;-</span> <span class="fu">crs</span>(LS_1m)</span>
<span id="cb21-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb21-4" aria-hidden="true" tabindex="-1"></a>vri <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(vri_data, empty_raster, <span class="at">field =</span> <span class="st">&quot;C_Factor&quot;</span>, <span class="at">res =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="sec-step-5-burn-severity-polygon-to-raster" class="section level4 unnumbered hasAnchor">
<h4>Step 5: Burn Severity Polygon to Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-5-burn-severity-polygon-to-raster" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb22-1" aria-hidden="true" tabindex="-1"></a>BurnSeverity_spdf <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(BurnSeverity)</span>
<span id="cb22-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb22-2" aria-hidden="true" tabindex="-1"></a>empty_raster <span class="ot">&lt;-</span><span class="fu">raster</span>(<span class="at">res =</span> <span class="dv">1</span>, <span class="at">ext =</span> extent)</span>
<span id="cb22-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(empty_raster) <span class="ot">&lt;-</span> <span class="fu">crs</span>(LS_1m)</span>
<span id="cb22-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb22-4" aria-hidden="true" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(BurnSeverity, empty_raster, <span class="at">field =</span> <span class="st">&quot;C_Factor&quot;</span>)</span></code></pre></div>
</div>
<div id="sec-step-5-road-polygon-to-raster-c" class="section level4 unnumbered hasAnchor">
<h4>Step 6: Road Polygon to Raster<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-5-road-polygon-to-raster-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb23-1" aria-hidden="true" tabindex="-1"></a>roads_data_spdf <span class="ot">&lt;-</span> <span class="fu">as_Spatial</span>(roads_buff_10)</span>
<span id="cb23-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb23-2" aria-hidden="true" tabindex="-1"></a>empty_raster <span class="ot">&lt;-</span><span class="fu">raster</span>(<span class="at">res =</span> <span class="dv">1</span>, <span class="at">ext =</span> extent)</span>
<span id="cb23-3"><a href="sec-methods-for-calculating-rusle-factors.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">crs</span>(empty_raster) <span class="ot">&lt;-</span> <span class="fu">crs</span>(LS_1m)</span>
<span id="cb23-4"><a href="sec-methods-for-calculating-rusle-factors.html#cb23-4" aria-hidden="true" tabindex="-1"></a>roads <span class="ot">&lt;-</span> <span class="fu">rasterize</span>(roads_buff_10, empty_raster, <span class="at">field =</span> <span class="st">&quot;C_Factor&quot;</span>, <span class="at">res =</span> <span class="dv">1</span>)</span></code></pre></div>
</div>
<div id="sec-step-6-c-factor-c" class="section level4 unnumbered hasAnchor">
<h4>Step 7: C Factor<a href="sec-methods-for-calculating-rusle-factors.html#sec-step-6-c-factor-c" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="sec-methods-for-calculating-rusle-factors.html#cb24-1" aria-hidden="true" tabindex="-1"></a>C_Factor_Post_Fire <span class="ot">&lt;-</span> <span class="fu">mosaic</span>(vri, roads, <span class="at">fun =</span> <span class="st">&quot;max&quot;</span>, <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span>
<span id="cb24-2"><a href="sec-methods-for-calculating-rusle-factors.html#cb24-2" aria-hidden="true" tabindex="-1"></a>C_Factor_Pre_Fire <span class="ot">&lt;-</span> <span class="fu">mosaic</span>(vri, roads, <span class="at">fun =</span> <span class="st">&quot;max&quot;</span>, <span class="at">tolerance =</span> <span class="fl">0.2</span>)</span></code></pre></div>
<p>This project is concerned with soil erosion modeling in a region which experienced a large fire. To that end, we produce two C Factor rasters, one pre-burn (<strong>Figure 20</strong>) and one post-burn (<strong>Figure 21</strong>).</p>
<center>
<img src="img/c_factor_pre_burn_roads10m.png" />}
</center>
<p><strong>Figure 20:</strong> Pre-burn Crop/Vegetation and Management Factor (C) for the Winlaw and Trozzo Creek watershed study areas.</p>
<center>
<img src="img/c_factor_post_burn_roads10m.png" />
</center>
<p><strong>Figure 21</strong>: Post-burn Crop/Vegetation and Management Factor (C) for the Winlaw and Trozzo Creek watershed study areas.</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sec-Data-Requirements.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="sec-applying-the-rusle-equation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/05-parts.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
